
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://intel-retail.github.io/documentation/use-cases/order-accuracy/architecture.html" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.3" name="generator"/>
<title>Order Accuracy System Architecture - Intel® Retail Organization</title>
<link href="../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../stylesheets/index.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<link href="../../stylesheets/branding.css" rel="stylesheet"/>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#order-accuracy-system-architecture">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Intel® Retail Organization" class="md-header__button md-logo" data-md-component="logo" href="../../index.html" title="Intel® Retail Organization">
<img alt="logo" src="../../images/logo-white-75px.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Intel® Retail Organization
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Order Accuracy System Architecture
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/intel-retail/documentation" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    intel-retail/documentation
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../index.html">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../Architecture/pipelines.html">
          
  
  
  Architecture Decisions

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../performance-tools/benchmark.html">
          
  
  
  Performance Tools

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../automated-self-checkout/automated-self-checkout.html">
          
  
  
  Use Cases

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../releasenotes.html">
        
  
  
    
  
  Releases

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../troubleshooting.html">
        
  
  
    
  
  Troubleshooting

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../workshops.html">
        
  
  
    
  
  Workshops

      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Intel® Retail Organization" class="md-nav__button md-logo" data-md-component="logo" href="../../index.html" title="Intel® Retail Organization">
<img alt="logo" src="../../images/logo-white-75px.png"/>
</a>
    Intel® Retail Organization
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/intel-retail/documentation" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    intel-retail/documentation
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../index.html">
<span class="md-ellipsis">
    
  
    Home
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Architecture Decisions
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Architecture Decisions
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Architecture/pipelines.html">
<span class="md-ellipsis">
    
  
    Pipelines
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    v2.0.0
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
            
  
    v2.0.0
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Architecture/v2.0.0/distributed-architecture.html">
<span class="md-ellipsis">
    
  
    Distributed Architecture
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Architecture/v2.0.0/multiple-ovms-json-config.html">
<span class="md-ellipsis">
    
  
    Multiple OVMS JSON Config
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Architecture/v2.0.0/performance_benchmarking.html">
<span class="md-ellipsis">
    
  
    Performance Benchmarking
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Architecture/v2.0.0/profile-launcher.html">
<span class="md-ellipsis">
    
  
    Profile Launcher
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Architecture/v2.0.0/target-device.html">
<span class="md-ellipsis">
    
  
    Target Device
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    v3.0.0
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
            
  
    v3.0.0
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Architecture/v3.0.0/aicsd-integration.html">
<span class="md-ellipsis">
    
  
    AiCSD Integration
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Performance Tools
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Performance Tools
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../performance-tools/benchmark.html">
<span class="md-ellipsis">
    
  
    Benchmarking
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Use Cases
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Use Cases
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Automated Self Checkout
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
            
  
    Automated Self Checkout
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../automated-self-checkout/automated-self-checkout.html">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Loss Prevention
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Loss Prevention
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../loss-prevention/loss-prevention.html">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../loss-prevention/architecture.html">
<span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../loss-prevention/getting_started.html">
<span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../loss-prevention/advanced.html">
<span class="md-ellipsis">
    
  
    Advanced Settings
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Order Accuracy
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Order Accuracy
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="order-accuracy.html">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="getting_started.html">
<span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="advanced.html">
<span class="md-ellipsis">
    
  
    Advanced Settings
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../releasenotes.html">
<span class="md-ellipsis">
    
  
    Releases
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../troubleshooting.html">
<span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../workshops.html">
<span class="md-ellipsis">
    
  
    Workshops
  

    
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="order-accuracy-system-architecture">Order Accuracy System Architecture</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#system-overview">System Overview</a></li>
<li><a href="#architecture-diagrams">Architecture Diagrams</a></li>
<li><a href="#component-details">Component Details</a></li>
<li><a href="#data-flow">Data Flow</a></li>
<li><a href="#production-features">Production Features</a></li>
</ol>
<h2 id="system-overview">System Overview</h2>
<p>The Order Accuracy platform is an enterprise AI vision system designed for real-time order validation in quick-service restaurant (QSR) environments. The system uses Vision Language Models (VLM) to analyze images or video feeds, automatically identifying items and validating them against order data.</p>
<h3 id="key-features">Key Features</h3>
<ul>
<li><strong>VLM-Powered Detection</strong>: Uses Qwen2.5-VL-7B for accurate item identification</li>
<li><strong>Intel Hardware Optimization</strong>: Optimized for Intel CPUs and GPUs via OpenVINO</li>
<li><strong>Dual Application Support</strong>: Dine-In (image-based) and Take-Away (video stream-based)</li>
<li><strong>Semantic Matching</strong>: Fuzzy matching for item name variations</li>
<li><strong>Real-time Processing</strong>: Sub-15-second validation for operational efficiency</li>
<li><strong>Containerized Deployment</strong>: Docker-based deployment with microservices architecture</li>
</ul>
<h2 id="architecture-diagrams">Architecture Diagrams</h2>
<h3 id="platform-architecture">Platform Architecture</h3>
<pre class="mermaid"><code>graph TB
    subgraph "Order Accuracy Platform"
        subgraph "Dine-In Application"
            DUI[Gradio UI :7861]
            DAPI[FastAPI API :8083]
            DVLM[VLM Client]
            DSEM[Semantic Client]
        end

        subgraph "Take-Away Application"
            TUI[Gradio UI :7860]
            TAPI[FastAPI API :8080]
            TSW[Station Workers]
            TVS[VLM Scheduler]
            TFS[Frame Selector]
        end

        subgraph "Shared Services"
            OVMS[OVMS VLM<br/>Qwen2.5-VL-7B]
            SEM[Semantic Service]
            MINIO[MinIO Storage]
        end
    end

    DUI --&gt; DAPI
    DAPI --&gt; DVLM
    DAPI --&gt; DSEM
    DVLM --&gt; OVMS
    DSEM --&gt; SEM

    TUI --&gt; TAPI
    TAPI --&gt; TSW
    TSW --&gt; TFS
    TSW --&gt; TVS
    TVS --&gt; OVMS
    TFS --&gt; MINIO
</code></pre>
<h3 id="dine-in-architecture">Dine-In Architecture</h3>
<div class="language-text highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                           DINE-IN ORDER ACCURACY                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐      ┌──────────────────┐      ┌─────────────────────┐    │
│  │             │      │                  │      │                     │    │
│  │  Gradio UI  │─────▶│   FastAPI API    │─────▶│   Validation        │    │
│  │  (Port 7861)│      │   (Port 8083)    │      │   Service           │    │
│  │             │      │                  │      │                     │    │
│  └─────────────┘      └────────┬─────────┘      └──────────┬──────────┘    │
│                                │                           │               │
│                    ┌───────────┴───────────┐               │               │
│                    │                       │               │               │
│                    ▼                       ▼               ▼               │
│           ┌────────────────┐     ┌─────────────────┐ ┌───────────────┐    │
│           │  VLM Client    │     │ Semantic Client │ │ Metrics       │    │
│           │  (Circuit      │     │ (Circuit        │ │ Collector     │    │
│           │   Breaker)     │     │  Breaker)       │ │               │    │
│           └───────┬────────┘     └────────┬────────┘ └───────────────┘    │
│                   │                       │                               │
└───────────────────┼───────────────────────┼───────────────────────────────┘
                    │                       │
                    ▼                       ▼
          ┌─────────────────┐     ┌─────────────────┐
          │   OVMS VLM      │     │   Semantic      │
          │   (Qwen2.5-VL)  │     │   Service       │
          └─────────────────┘     └─────────────────┘
</code></pre></div>
<h3 id="take-away-architecture">Take-Away Architecture</h3>
<div class="language-text highlight"><pre><span></span><code>┌──────────────────────────────────────────────────────────────────────────────────────┐
│                            TAKE-AWAY ORDER ACCURACY SYSTEM                           │
│                                                                                      │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐                  │
│  │    RTSP Video   │    │  Frame Selector │    │      Order      │                  │
│  │     Streams     │───▶│     Service     │───▶│    Accuracy     │                  │
│  │   (GStreamer)   │    │     (YOLO)      │    │    Service      │                  │
│  └─────────────────┘    └─────────────────┘    └────────┬────────┘                  │
│                                                          │                           │
│         ┌────────────────────────────────────────────────┤                           │
│         │                                                │                           │
│         ▼                                                ▼                           │
│  ┌─────────────────┐                          ┌─────────────────┐                   │
│  │   VLM Scheduler │                          │    Validation   │                   │
│  │   (Batcher)     │                          │      Agent      │                   │
│  └────────┬────────┘                          └────────┬────────┘                   │
│           │                                            │                             │
│           ▼                                            ▼                             │
│  ┌─────────────────┐                          ┌─────────────────┐                   │
│  │    OVMS VLM     │                          │    Semantic     │                   │
│  │  (Qwen2.5-VL)   │                          │    Service      │                   │
│  └─────────────────┘                          └─────────────────┘                   │
│                                                                                      │
└──────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<h2 id="component-details">Component Details</h2>
<h3 id="core-components">Core Components</h3>
<h4 id="1-vlm-backend-ovms">1. VLM Backend (OVMS)</h4>
<p>OpenVINO Model Server hosting Qwen2.5-VL-7B for vision-language inference.</p>
<p><strong>Features:</strong>
- OpenAI-compatible API (<code>/v3/chat/completions</code>)
- INT8 quantization for optimized performance
- GPU acceleration via Intel/NVIDIA hardware
- Shared model instance for both applications</p>
<p><strong>API Usage:</strong>
<div class="language-python highlight"><pre><span></span><code><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">OVMS_ENDPOINT</span><span class="si">}</span><span class="s2">/v3/chat/completions"</span><span class="p">,</span>
    <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"model"</span><span class="p">:</span> <span class="s2">"Qwen/Qwen2.5-VL-7B-Instruct"</span><span class="p">,</span>
        <span class="s2">"messages"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">"role"</span><span class="p">:</span> <span class="s2">"user"</span><span class="p">,</span>
                <span class="s2">"content"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"text"</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">:</span> <span class="n">prompt</span><span class="p">},</span>
                    <span class="p">{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"image_url"</span><span class="p">,</span> <span class="s2">"image_url"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"url"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"data:image/jpeg;base64,</span><span class="si">{</span><span class="n">img_b64</span><span class="si">}</span><span class="s2">"</span><span class="p">}}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div></p>
<h4 id="2-semantic-comparison-service">2. Semantic Comparison Service</h4>
<p>AI-powered semantic matching microservice for intelligent item comparison.</p>
<p><strong>Matching Strategies:</strong>
- <strong>Exact</strong>: Direct string comparison
- <strong>Semantic</strong>: Vector similarity using sentence-transformers
- <strong>Hybrid</strong>: Exact first, then semantic fallback</p>
<p><strong>Example Matches:</strong>
- "Big Mac" ↔ "Maharaja Mac" (regional name variant)
- "green apple" ↔ "apple" (partial match)
- "large fries" ↔ "french fries large" (word reordering)</p>
<h4 id="3-frame-selector-service-take-away">3. Frame Selector Service (Take-Away)</h4>
<p>YOLO-based intelligent frame selection for optimal VLM input.</p>
<p><strong>Process:</strong>
1. Receive raw video frames from GStreamer pipeline
2. Run YOLO object detection on each frame
3. Score frames by item visibility and clarity
4. Select top K frames per order
5. Store selected frames in MinIO</p>
<h4 id="4-vlm-scheduler-take-away">4. VLM Scheduler (Take-Away)</h4>
<p>Request batching scheduler optimizing OVMS throughput.</p>
<p><strong>Batching Strategy:</strong>
- Time Window: 50-100ms collection period
- Max Batch Size: Configurable (default: 16)
- Fair Scheduling: Round-robin across workers
- Response Routing: Match responses to original requesters</p>
<h3 id="docker-services">Docker Services</h3>
<h4 id="dine-in-services">Dine-In Services</h4>
<table>
<thead>
<tr>
<th>Container</th>
<th>Ports</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dinein_app</code></td>
<td>7861, 8083</td>
<td>Main application (Gradio + FastAPI)</td>
</tr>
<tr>
<td><code>dinein_ovms_vlm</code></td>
<td>8002</td>
<td>Vision-Language Model server</td>
</tr>
<tr>
<td><code>dinein_semantic_service</code></td>
<td>8081</td>
<td>Semantic text matching</td>
</tr>
<tr>
<td><code>metrics-collector</code></td>
<td>8084</td>
<td>System metrics aggregation</td>
</tr>
</tbody>
</table>
<h4 id="take-away-services">Take-Away Services</h4>
<table>
<thead>
<tr>
<th>Container</th>
<th>Ports</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>takeaway_app</code></td>
<td>7860, 8080</td>
<td>Main application (Gradio + FastAPI)</td>
</tr>
<tr>
<td><code>ovms-vlm</code></td>
<td>8001</td>
<td>Vision-Language Model server</td>
</tr>
<tr>
<td><code>frame-selector</code></td>
<td>8085</td>
<td>YOLO-based frame selection</td>
</tr>
<tr>
<td><code>semantic-service</code></td>
<td>8081</td>
<td>Semantic text matching</td>
</tr>
<tr>
<td><code>minio</code></td>
<td>9000, 9001</td>
<td>S3-compatible storage</td>
</tr>
<tr>
<td><code>rtsp-streamer</code></td>
<td>8554</td>
<td>RTSP stream simulator (testing)</td>
</tr>
</tbody>
</table>
<h2 id="data-flow">Data Flow</h2>
<h3 id="dine-in-validation-pipeline">Dine-In Validation Pipeline</h3>
<div class="language-text highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────┐
│                        VALIDATION PIPELINE                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  1. IMAGE PREPROCESSING                                            │
│     Raw Image → Auto-Orient → Resize (672px) → Enhance →           │
│     Sharpen → JPEG Compress (82%) → Base64 Encode                  │
│                              │                                      │
│                              ▼                                      │
│  2. VLM INFERENCE                                                  │
│     Prompt: "Analyze this food plate image..."                     │
│     + Inventory list for context                                   │
│     → OVMS POST /v3/chat/completions                               │
│     → Parse JSON response for detected items                       │
│                              │                                      │
│                              ▼                                      │
│  3. SEMANTIC MATCHING                                              │
│     For each expected item:                                        │
│       Find best match in detected items (similarity &gt; 0.7)         │
│       Track: matched, missing, extra, quantity mismatches          │
│                              │                                      │
│                              ▼                                      │
│  4. RESULT AGGREGATION                                             │
│     {                                                              │
│       "order_complete": true/false,                                │
│       "accuracy_score": 0.0-1.0,                                   │
│       "missing_items": [...],                                      │
│       "extra_items": [...]                                         │
│     }                                                              │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<h3 id="take-away-processing-pipeline">Take-Away Processing Pipeline</h3>
<div class="language-text highlight"><pre><span></span><code>┌────────────────────────────────────────────────────────────────────────────┐
│                         DATA FLOW PIPELINE                                  │
│                                                                             │
│  1. VIDEO CAPTURE                                                          │
│     RTSP Camera ──▶ GStreamer Pipeline ──▶ Frame Buffer                   │
│                                                                             │
│  2. FRAME SELECTION                                                        │
│     Frame Selector (YOLO):                                                 │
│     • Object detection on raw frames                                       │
│     • Score frames by item visibility                                      │
│     • Select top K frames per order                                        │
│     • Store selected frames in MinIO                                       │
│                                                                             │
│  3. VLM PROCESSING                                                         │
│     VLM Scheduler → OVMS (Qwen2.5-VL):                                    │
│     • Batch frames by time window                                          │
│     • Send to OVMS with detection prompt                                   │
│     • Parse structured item response                                       │
│                                                                             │
│  4. ORDER VALIDATION                                                       │
│     Validation Agent:                                                      │
│     • Compare detected items with expected order                           │
│     • Exact match → Semantic match → Flag mismatch                        │
│     • Generate validation result                                           │
│                                                                             │
│  5. RESULT OUTPUT                                                          │
│     { "matched": [...], "missing": [...], "extra": [...] }                │
│                                                                             │
└────────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<h2 id="production-features">Production Features</h2>
<h3 id="circuit-breaker-pattern">Circuit Breaker Pattern</h3>
<p>Prevents cascading failures when external services are unhealthy.</p>
<div class="language-text highlight"><pre><span></span><code>                    5 consecutive failures
       ┌────────┐ ───────────────────────────▶ ┌────────┐
       │        │                               │        │
       │ CLOSED │                               │  OPEN  │
       │        │ ◀─────────────────────────── │        │
       └────────┘    2 successes in half_open  └────────┘
            ▲                                       │
            │                                       │
            │        ┌────────────┐                 │
            └────────│ HALF_OPEN  │◀────────────────┘
      2 successes    └────────────┘    30s timeout
                           │
                           │ 1 failure → Back to OPEN
</code></pre></div>
<p><strong>Configuration:</strong>
- VLM Client: 5 failures → OPEN, 30s recovery → HALF_OPEN
- Semantic Client: 15s recovery timeout (faster than VLM)</p>
<h3 id="connection-pooling">Connection Pooling</h3>
<div class="language-python highlight"><pre><span></span><code><span class="c1"># VLM Client Pool Configuration</span>
<span class="n">limits</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Limits</span><span class="p">(</span>
    <span class="n">max_keepalive_connections</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">max_connections</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">keepalive_expiry</span><span class="o">=</span><span class="mf">30.0</span>
<span class="p">)</span>
<span class="n">timeout</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Timeout</span><span class="p">(</span>
    <span class="n">connect</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">read</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span>   <span class="c1"># Extended for VLM inference</span>
    <span class="n">write</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">pool</span><span class="o">=</span><span class="mf">10.0</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="bounded-cache-lru">Bounded Cache (LRU)</h3>
<p>Thread-safe LRU cache with automatic eviction to prevent memory exhaustion:
- Maximum 10,000 entries
- Automatic eviction of oldest entries when full
- Thread-safe operations with locking</p>
<h3 id="station-worker-reliability-take-away">Station Worker Reliability (Take-Away)</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>GStreamer Pipeline</td>
<td>RTSP → H.264 decode → Frame capture</td>
</tr>
<tr>
<td>Circuit Breaker</td>
<td>5 failures in 5 min → 30s cooldown</td>
</tr>
<tr>
<td>Exponential Backoff</td>
<td>2s → 4s → 8s → ... → 60s max</td>
</tr>
<tr>
<td>Stall Detection</td>
<td>No frames for 5 min triggers restart</td>
</tr>
<tr>
<td>Health Monitoring</td>
<td>Frame rate, pipeline state tracking</td>
</tr>
</tbody>
</table>
<h3 id="performance-characteristics">Performance Characteristics</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Dine-In</th>
<th>Take-Away</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>End-to-End Latency</strong></td>
<td>8-15 seconds</td>
<td>Real-time stream</td>
</tr>
<tr>
<td><strong>VLM Inference</strong></td>
<td>5-10 seconds</td>
<td>5-10 seconds (batched)</td>
</tr>
<tr>
<td><strong>Semantic Matching</strong></td>
<td>50-200ms</td>
<td>50-200ms</td>
</tr>
<tr>
<td><strong>Throughput</strong></td>
<td>~4-6 req/min</td>
<td>Multiple concurrent streams</td>
</tr>
<tr>
<td><strong>GPU Utilization</strong></td>
<td>60-80%</td>
<td>70-90% (parallel mode)</td>
</tr>
</tbody>
</table>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024 Intel Corporation
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "navigation.tracking", "search.suggest", "search.highlight", "navigation.top", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
<script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body>
</html>